{% extends "base.html" %}

{% macro render_modal(submission, id) -%}
<div class="modal fade" id="{{ id }}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Judge {{ submission.anon_name }}</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="form-row">
                        <div class="col">
                            <label class="sr-only" for="musicalRepr">Musical Representation</label>
                            <div class="input-group mb-2">
                                <input type="number" step="0.01" class="form-control" id="musicalRepr"
                                    placeholder="Musical Representation">
                                <div class="input-group-append">
                                    <div class="input-group-text">/30</div>
                                </div>
                            </div>
                        </div>
                        <div class="col">
                            <label class="sr-only" for="gameplay">Gameplay</label>
                            <div class="input-group mb-2">
                                <input type="number" step="0.01" class="form-control" id="gameplay"
                                    placeholder="Gameplay">
                                <div class="input-group-append">
                                    <div class="input-group-text">/30</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="col">
                            <label class="sr-only" for="creativity">Creativity</label>
                            <div class="input-group mb-2">
                                <input type="number" step="0.01" class="form-control" id="creativity"
                                    placeholder="Creativity">
                                <div class="input-group-append">
                                    <div class="input-group-text">/30</div>
                                </div>
                            </div>
                        </div>

                        <div class="col">
                            <label class="sr-only" for="hitsounding">Hitsounding</label>
                            <div class="input-group mb-2">
                                <input type="number" step="0.01" class="form-control" id="hitsounding"
                                    placeholder="Hitsounding">
                                <div class="input-group-append">
                                    <div class="input-group-text">/10</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-row">
                        <label for="exampleFormControlTextarea1">Overall Comment</label>
                        <textarea class="form-control" id="exampleFormControlTextarea1" rows="3"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary">Save changes</button>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
{%- endmacro %}

{% block header %}
<div class="py-5 text-center">
    <h2>Judge</h2>
</div>
{% endblock %}

{% block content %}
<div class="row justify-content-center pb-3">
    <ul class="list-group">
        {% for s in submissions %}
        {% set level = "success" if s.has_judged else "danger" %}
        <li class="list-group-item">
            {{ s.anon_name }} -- {{ s.difficulty }}
            <span class="badge badge-{{ level }} badge-pill">
                {% if not s.has_judged %}
                Not judged
                {%else%}
                Judged
                {% endif %}
            </span>
            <button type="button" class="btn btn-primary" data-toggle="modal"
                data-target="#modal{{ loop.index0 }}">Judge</button>
        </li>
        {% endfor %}
    </ul>
</div>

{% for s in submissions %}
{% set i = loop.index0 | string %}
{{ render_modal(s, "modal" + i) }}
{% endfor %}
{% endblock %}